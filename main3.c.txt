#include <stdio.h>
#include <string.h>

int main() {
    FILE *fp_in, *fp_out;
    char c;
    int line_number = 1;
    char buffer[1000];

    fp_in = fopen(__FILE__, "r");

    fp_out = fopen("main2.txt", "w");

    if (fp_in == NULL || fp_out == NULL) {
        printf("無法開啟檔案\n");
        return 1;
    }

    while (fgets(buffer, sizeof(buffer), fp_in)) {
        if (strstr(buffer, "int main()") != NULL || strstr(buffer, "int main (") != NULL) {
            fprintf(fp_out, "main 函數位於第 %d 行\n", line_number);
            break;
        }
        line_number++;
    }

    fclose(fp_in);
    fclose(fp_out);

    return 0;
}